#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# ì»¤ë°‹ ë©”ì‹œì§€ íŒŒì¼ ê²½ë¡œ
commit_msg_file=$1
commit_msg=$(cat "$commit_msg_file")

# ì»¨ë²¤ì…”ë„ ì»¤ë°‹ íŒ¨í„´
# feat: ìƒˆë¡œìš´ ê¸°ëŠ¥
# fix: ë²„ê·¸ ìˆ˜ì •
# docs: ë¬¸ì„œ ìˆ˜ì •
# style: ì½”ë“œ í¬ë§·íŒ…, ì„¸ë¯¸ì½œë¡  ëˆ„ë½, ì½”ë“œ ë³€ê²½ì´ ì—†ëŠ” ê²½ìš°
# refactor: ì½”ë“œ ë¦¬íŒ©í† ë§
# test: í…ŒìŠ¤íŠ¸ ì¶”ê°€, í…ŒìŠ¤íŠ¸ ë¦¬íŒ©í† ë§
# chore: ë¹Œë“œ ì—…ë¬´ ìˆ˜ì •, íŒ¨í‚¤ì§€ ë§¤ë‹ˆì € ìˆ˜ì •
pattern="^(feat|fix|docs|style|refactor|test|chore|perf|ci|build|revert)(\(.+\))?: .{1,50}"

if ! echo "$commit_msg" | grep -qE "$pattern"; then
    echo "âŒ Invalid commit message format!"
    echo ""
    echo "ğŸ“‹ Commit message should follow Conventional Commits format:"
    echo "   <type>[optional scope]: <description>"
    echo ""
    echo "ğŸ“ Examples:"
    echo "   feat: add user authentication"
    echo "   fix: resolve login redirect issue"
    echo "   docs: update API documentation"
    echo "   feat(auth): implement JWT token validation"
    echo ""
    echo "ğŸ·ï¸  Valid types: feat, fix, docs, style, refactor, test, chore, perf, ci, build, revert"
    echo ""
    echo "ğŸ’¡ Your commit message: '$commit_msg'"
    exit 1
fi

echo "âœ… Commit message format is valid!" 