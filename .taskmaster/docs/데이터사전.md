## 📊 BIOFOX 데이터 사전 (Data Dictionary)

### 1. 기본 데이터 정의

#### 1.1 사용자 관련
| 용어 | 정의 | 영문명 | 비고 |
|------|------|--------|------|
| 사용자 | 시스템을 이용하는 모든 개인 | User | 관리자, KOL, OL, Shop Owner 포함 |
| 관리자 | 시스템 전체를 관리하는 바이오폭스 직원 | Admin | 모든 데이터 입력 권한 |
| KOL | Key Opinion Leader, 최고 등급 전문점 원장 | KOL | 수수료 30% |
| OL | Opinion Leader, 중간 등급 전문점 원장 | OL | 수수료 20% |
| 전문점 원장 | 일반 등급 전문점 운영자 | Shop Owner | 수수료 없음 |
| 본인샵 | KOL/OL이 직접 운영하는 에스테틱샵 | Self Shop | 전문점 수 계산 시 제외 |
| 소속 전문점 | KOL/OL 산하의 전문점들 | Sub Shop | 수수료 대상 |

#### 1.2 비즈니스 용어
| 용어 | 정의 | 영문명 | 비고 |
|------|------|--------|------|
| 매출 | 특정 기간 동안의 제품/기기 판매 금액 | Sales | 양수/음수 모두 가능 |
| 수수료 | 매출에 따라 KOL/OL에게 지급되는 보상 | Commission | 월별 계산 |
| 활성 전문점 | 당월 매출이 발생한 전문점 | Active Shop | 본인샵 제외 |
| 누적 대수 | KOL/OL이 판매한 기기의 총 대수 | Accumulated Devices | 티어 결정 기준 |
| 임상 회차 | 동일 대상의 시술 횟수 | Clinical Session | 제한 없음 |

### 2. 코드 체계 정의

#### 2.1 사용자 역할 코드 (User Role)
| 코드 | 명칭 | 설명 |
|------|------|------|
| admin | 관리자 | 시스템 전체 관리 권한 |
| kol | KOL | Key Opinion Leader, 수수료 30% |
| ol | OL | Opinion Leader, 수수료 20% |
| shop_owner | 전문점 원장 | 일반 전문점 운영자 |

#### 2.2 승인 상태 코드 (Approval Status)
| 코드 | 명칭 | 설명 |
|------|------|------|
| pending | 승인 대기 | 회원가입 후 초기 상태 |
| approved | 승인 완료 | 관리자 승인 후 시스템 이용 가능 |
| rejected | 승인 거절 | 관리자가 가입 거절 |

#### 2.3 CRM 단계 코드 (CRM Stage)
| 단계 | 코드 | 명칭 | 설명 |
|------|------|------|------|
| 1 | initial_contact | 유입 | 최초 접촉 및 관심 표명 |
| 2 | contract | 계약 | 전문점 계약 체결 |
| 3 | basic_education | 교육 | 기본 제품/기기 사용법 교육 |
| 4 | clinical_start | 임상 | 실제 시술 시작 및 진행 |
| 5 | evaluation | 평가 | 시술 결과 평가 및 피드백 |
| 6 | advanced_education | 심화교육 | 추가 교육 과정 수강 |
| 7 | renewal | 재계약 | 계약 갱신 및 지속 관계 |
| 8 | expansion | 확장 | 추가 제품/서비스 도입 |
| 9 | mentoring | 멘토링 | 지속적 관리 및 상담 |
| 10 | performance | 성과관리 | 매출 분석 및 성과 관리 |

#### 2.4 CRM 자가평가 질문 코드
| 번호 | 코드 | 질문 내용 | 연동 여부 |
|------|------|----------|----------|
| 1 | q1_cleobios_inquiry | 클레오비스는 세탁하였는가? | ✅ Shop → KOL |
| 2 | q2_instasure_inquiry | 인스타슈어 세탁하였는가? | ✅ Shop → KOL |
| 3 | q3_proper_procedure | 정품 및 정량 프로토콜로 시행하고 있는가? | ✅ Shop → KOL |
| 4 | q4_progress_check | 상품 진행이 잘 되어가는가? | ✅ Shop → KOL |
| 5 | q5_feedback_need | 상담을 잘 이루어내는가? | ❌ KOL 전용 |
| 6 | q6_management | 샵을 잘관리하고 있는가? | ❌ KOL 전용 |

#### 2.5 교육 유형 코드 (Education Type)
| 코드 | 명칭 | 설명 |
|------|------|------|
| installation | 설치교육 | 기기 설치 및 기본 사용법 교육 |
| company_training | 본사실무교육 | 본사에서 제공하는 실무 교육 |
| advanced_training | 심화교육 | 고급 시술법 및 관리법 교육 |

#### 2.6 교육 상태 코드 (Education Status)
| 코드 | 명칭 | 설명 |
|------|------|------|
| not_started | 미시작 | 교육 신청 전 |
| applied | 신청완료 | 교육 신청됨 |
| in_progress | 진행중 | 교육 수강 중 |
| completed | 완료 | 교육 이수 완료 |

#### 2.7 임상 상태 코드 (Clinical Status)
| 코드 | 명칭 | 설명 |
|------|------|------|
| in_progress | 진행중 | 임상 진행 중 |
| completed | 완료 | 임상 완료 |
| paused | 일시중단 | 고객 사정으로 중단 |
| cancelled | 취소 | 임상 취소 |

#### 2.8 동의 상태 코드 (Consent Status)
| 코드 | 명칭 | 설명 |
|------|------|------|
| no_consent | 미동의 | 활용 동의하지 않음 |
| consented | 동의 | 활용 동의함 |
| pending | 보류 | 동의 여부 미결정 |

#### 2.9 임상 대상 코드 (Clinical Subject)
| 코드 | 명칭 | 설명 |
|------|------|------|
| self | 본인 | 샵 원장님 본인 임상 |
| customer | 고객 | 샵의 실제 고객 임상 |

#### 2.10 사진 타입 코드 (Photo Type)
| 코드 | 명칭 | 설명 |
|------|------|------|
| front | 정면 | 정면 사진 |
| left_side | 좌측면 | 좌측면 사진 |
| right_side | 우측면 | 우측면 사진 |

#### 2.11 기기 티어 코드 (Device Tier)
| 코드 | 명칭 | 설명 | 수수료 |
|------|------|------|-------|
| tier_1_4 | 1-4대 | 누적 1-4대 구간 | 150만원/대 |
| tier_5_plus | 5대 이상 | 누적 5대 이상 구간 | 250만원/대 |

#### 2.12 수수료 상태 코드 (Commission Status)
| 코드 | 명칭 | 설명 |
|------|------|------|
| calculated | 계산완료 | 수수료 계산됨 |
| adjusted | 조정됨 | 관리자가 수동 조정 |
| paid | 지급완료 | 수수료 지급됨 |

### 3. 데이터 타입 및 제약조건

#### 3.1 문자열 길이 제한
| 필드명 | 최소 길이 | 최대 길이 | 비고 |
|--------|----------|----------|------|
| 이름 (name) | 2 | 50 | 한글, 영문 모두 허용 |
| 이메일 (email) | 5 | 100 | 이메일 형식 검증 |
| 샵명 (shop_name) | 2 | 100 | 특수문자 제한 |
| 전화번호 (phone) | 10 | 15 | 숫자, 하이픈만 허용 |
| 지역 (region) | 2 | 50 | 자유 입력 |
| 메모 (notes) | 0 | 1000 | 개행 문자 허용 |

#### 3.2 숫자 범위 제한
| 필드명 | 최솟값 | 최댓값 | 소수점 자리 |
|--------|--------|--------|-------------|
| 매출 금액 (sales_amount) | -999,999,999 | 999,999,999 | 2자리 |
| 수수료율 (commission_rate) | 0 | 100 | 2자리 |
| 수수료 금액 (commission_amount) | -999,999,999 | 999,999,999 | 2자리 |
| 기기 수량 (device_quantity) | -999 | 999 | 0자리 |
| 임상 회차 (session_number) | 0 | 999 | 0자리 |

#### 3.3 파일 제약조건
| 파일 타입 | 최대 크기 | 허용 확장자 | 저장 경로 |
|----------|----------|-------------|----------|
| 임상 사진 | 10MB | jpg, jpeg, png, webp | /clinical/photos/ |
| 동의서 | 5MB | pdf, jpg, jpeg, png | /clinical/consents/ |
| 프로필 사진 | 2MB | jpg, jpeg, png | /profiles/ |

### 4. 날짜/시간 형식

#### 4.1 표준 형식
| 용도 | 형식 | 예시 | 비고 |
|------|------|------|------|
| 날짜 | YYYY-MM-DD | 2025-01-15 | ISO 8601 표준 |
| 시간 | HH:MM:SS | 14:30:25 | 24시간 형식 |
| 날짜시간 | YYYY-MM-DD HH:MM:SS | 2025-01-15 14:30:25 | UTC 기준 |
| 월별 집계 | YYYY-MM-01 | 2025-01-01 | 월의 첫째 날로 저장 |

#### 4.2 특수 날짜 규칙
- **소속 시작일**: 관계 생성 시점 자동 설정
- **소속 종료일**: 관계 변경 시 이전 관계에 설정
- **승인일**: 관리자 승인 시점 자동 설정
- **임상일**: 각 회차별 시술 날짜

### 5. 유효성 검증 규칙

#### 5.1 이메일 검증
- 정규표현식: `^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$`
- 중복 검사: 시스템 전체에서 유일해야 함

#### 5.2 전화번호 검증
- 정규표현식: `^[0-9-]{10,15}$`
- 한국 번호 형식 우선 지원

#### 5.3 날짜 검증
- 임상일은 현재 날짜 이후 불가
- 소속 시작일은 종료일보다 이전이어야 함
- 교육 완료일은 신청일 이후여야 함