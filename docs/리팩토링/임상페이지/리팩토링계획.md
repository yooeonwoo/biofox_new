ì™„ë²½í•©ë‹ˆë‹¤! ì œê³µí•´ì£¼ì‹  ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ êµ¬ì²´ì ì¸ ë¦¬íŒ©í† ë§ ê³„íšì„ ì„¸ì›Œë³´ê² ìŠµë‹ˆë‹¤.

## ğŸ“‹ í†µí•© ë¦¬íŒ©í† ë§ ê³„íš

### Phase 1: íƒ€ì… ë° ìƒìˆ˜ ì •ë¦¬ (1ì¼)

#### 1. íƒ€ì… íŒŒì¼ ìƒì„±
```typescript
// app/kol-new/clinical-photos/types.ts
export const PERSONAL_CASE_NAME = 'ë³¸ì¸' as const;
export const PERSONAL_PREFIX = '[ë³¸ì¸] ' as const;

export interface ClinicalCase {
  id: string;
  customerName: string;
  status: CaseStatus;
  // ... ê¸°ì¡´ íƒ€ì…ë“¤
}

export interface CaseCardProps {
  type: 'personal' | 'customer';
  case: ClinicalCase;
  editableName?: boolean;
  showDelete?: boolean;
  showNewBadge?: boolean;
  onUpdate: (caseId: string, updates: Partial<ClinicalCase>) => void;
  onDelete?: (caseId: string) => void;
  // ... ê¸°íƒ€ ì½œë°±ë“¤
}

// app/kol-new/clinical-photos/constants.ts
export const SYSTEM_OPTIONS = {
  genders: [...],
  treatmentTypes: [...],
  products: [...],
  skinTypes: [...]
} as const;
```

### Phase 2: API ë ˆì´ì–´ ì •ë¦¬ (1-2ì¼)

#### 1. ì„œë¹„ìŠ¤ ë ˆì´ì–´ í™•ì¥
```typescript
// lib/clinical-photos.ts
export const fetchPersonalCase = async () => {
  const allCases = await fetchCases();
  return allCases.find(case_ => case_.customerName?.trim() === PERSONAL_CASE_NAME);
};

export const ensurePersonalCaseExists = async () => {
  const existingCase = await fetchPersonalCase();
  if (!existingCase) {
    return await createCase({
      customerName: PERSONAL_CASE_NAME,
      caseName: 'ë³¸ì¸ ì„ìƒ ì¼€ì´ìŠ¤',
      concernArea: 'ë³¸ì¸ ì¼€ì–´',
      treatmentPlan: `${PERSONAL_PREFIX}ê°œì¸ ê´€ë¦¬ ê³„íš`,
      consentReceived: false,
    });
  }
  return existingCase;
};

export const fetchCustomerCases = async () => {
  const allCases = await fetchCases();
  return allCases.filter(case_ => 
    case_.customerName?.trim() !== PERSONAL_CASE_NAME
  );
};
```

### Phase 3: ì»¤ìŠ¤í…€ í›… ìƒì„± (2-3ì¼)

#### 1. ì¼€ì´ìŠ¤ ê´€ë¦¬ í›…
```typescript
// app/kol-new/clinical-photos/hooks/useCaseManagement.ts
export const useCaseManagement = (type: 'personal' | 'customer') => {
  const [cases, setCases] = useState<ClinicalCase[]>([]);
  const [loading, setLoading] = useState(true);
  
  const loadCases = async () => {
    setLoading(true);
    try {
      const data = type === 'personal' 
        ? [await ensurePersonalCaseExists()]
        : await fetchCustomerCases();
      
      const transformedCases = await transformCases(data);
      setCases(transformedCases);
    } finally {
      setLoading(false);
    }
  };
  
  return { cases, loading, loadCases, setCases };
};
```

#### 2. ì‚¬ì§„ ê´€ë¦¬ í›…
```typescript
// app/kol-new/clinical-photos/hooks/usePhotoManagement.ts
export const usePhotoManagement = () => {
  const handlePhotoUpload = async (caseId: string, roundDay: number, angle: string, file: File) => {
    // ê³µí†µ ë¡œì§
  };
  
  const handlePhotoDelete = async (caseId: string, roundDay: number, angle: string) => {
    // ê³µí†µ ë¡œì§
  };
  
  return { handlePhotoUpload, handlePhotoDelete };
};
```

#### 3. IME ì²˜ë¦¬ í›…
```typescript
// hooks/useIME.ts (ì „ì—­)
export const useIME = () => {
  const [isComposing, setIsComposing] = useState(false);
  const [debounceTimers, setDebounceTimers] = useState<{[key: string]: NodeJS.Timeout}>({});
  
  const debouncedUpdate = (key: string, updateFn: () => void, delay: number = 500) => {
    // ê¸°ì¡´ ë¡œì§
  };
  
  return { isComposing, setIsComposing, debouncedUpdate };
};
```

### Phase 4: ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬ (3-4ì¼)

#### 1. CaseCard ì»´í¬ë„ŒíŠ¸
```typescript
// app/kol-new/clinical-photos/components/CaseCard/index.tsx
export const CaseCard: React.FC<CaseCardProps> = ({
  type,
  case: caseData,
  editableName = true,
  showDelete = false,
  showNewBadge = false,
  onUpdate,
  onDelete,
  // ... ê¸°íƒ€ props
}) => {
  return (
    <Card>
      <CaseHeader 
        case={caseData}
        showDelete={showDelete}
        onDelete={onDelete}
      />
      <CardContent>
        <PhotoSection {...} />
        <CustomerInfoSection 
          case={caseData}
          editableName={editableName}
          onUpdate={onUpdate}
        />
        <ProductSection {...} />
        <SkinTypeSection {...} />
        <MemoSection {...} />
      </CardContent>
    </Card>
  );
};
```

#### 2. ì„¹ì…˜ë³„ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸
```typescript
// app/kol-new/clinical-photos/components/CaseCard/CustomerInfoSection.tsx
export const CustomerInfoSection: React.FC<{
  case: ClinicalCase;
  editableName: boolean;
  onUpdate: (updates: Partial<CustomerInfo>) => void;
}> = ({ case: caseData, editableName, onUpdate }) => {
  return (
    <div>
      {editableName ? (
        <Input value={caseData.customerName} onChange={...} />
      ) : (
        <span>{caseData.customerName}</span>
      )}
      {/* ë‚˜ë¨¸ì§€ í•„ë“œë“¤ */}
    </div>
  );
};
```

### Phase 5: í˜ì´ì§€ ë¦¬íŒ©í† ë§ (2ì¼)

#### 1. ê³ ê° í˜ì´ì§€
```typescript
// app/kol-new/clinical-photos/upload/page.tsx
export default function CustomerClinicalUploadPage() {
  const { cases, loading, setCases } = useCaseManagement('customer');
  const { handlePhotoUpload, handlePhotoDelete } = usePhotoManagement();
  
  return (
    <div>
      {/* ìƒˆ ê³ ê° ì¶”ê°€ ë²„íŠ¼ */}
      {cases.map(case_ => (
        <CaseCard
          key={case_.id}
          type="customer"
          case={case_}
          editableName={true}
          showDelete={isNewCustomer(case_.id)}
          showNewBadge={isNewCustomer(case_.id)}
          onUpdate={handleCaseUpdate}
          onDelete={handleDeleteCase}
        />
      ))}
    </div>
  );
}
```

#### 2. ë³¸ì¸ í˜ì´ì§€
```typescript
// app/kol-new/clinical-photos/upload/personal/page.tsx
export default function PersonalClinicalUploadPage() {
  const { cases, loading } = useCaseManagement('personal');
  const { handlePhotoUpload, handlePhotoDelete } = usePhotoManagement();
  
  return (
    <div>
      {cases.map(case_ => (
        <CaseCard
          key={case_.id}
          type="personal"
          case={case_}
          editableName={false}  // ë³¸ì¸ ì´ë¦„ ìˆ˜ì • ë¶ˆê°€
          showDelete={false}    // ì‚­ì œ ë²„íŠ¼ ì—†ìŒ
          onUpdate={handleCaseUpdate}
        />
      ))}
    </div>
  );
}
```

### Phase 6: í…ŒìŠ¤íŠ¸ ì‘ì„± (1-2ì¼)

```typescript
// app/kol-new/clinical-photos/hooks/__tests__/useCaseManagement.test.ts
describe('useCaseManagement', () => {
  it('personal íƒ€ì…ì¼ ë•Œ ë³¸ì¸ ì¼€ì´ìŠ¤ë¥¼ ìë™ ìƒì„±í•œë‹¤', async () => {
    // ...
  });
  
  it('customer íƒ€ì…ì¼ ë•Œ ë³¸ì¸ ì¼€ì´ìŠ¤ë¥¼ ì œì™¸í•œë‹¤', async () => {
    // ...
  });
});
```

### ğŸš€ ì‹¤í–‰ ê³„íš

1. **Week 1**: Phase 1-2 (íƒ€ì…/ìƒìˆ˜ ì •ë¦¬, API ë ˆì´ì–´)
2. **Week 2**: Phase 3-4 (ì»¤ìŠ¤í…€ í›…, ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬)
3. **Week 3**: Phase 5-6 (í˜ì´ì§€ ë¦¬íŒ©í† ë§, í…ŒìŠ¤íŠ¸)

### ğŸ¯ ì£¼ìš” ê°œì„ ì‚¬í•­

1. **ì¤‘ë³µ ì½”ë“œ ì œê±°**: 2000ì¤„ â†’ ~500ì¤„ë¡œ ê° í˜ì´ì§€ ì¶•ì†Œ
2. **ìœ ì§€ë³´ìˆ˜ì„±**: ê³µí†µ ë¡œì§ ìˆ˜ì • ì‹œ í•œ ê³³ë§Œ ìˆ˜ì •
3. **íƒ€ì… ì•ˆì •ì„±**: ê³µí†µ íƒ€ì… ì •ì˜ë¡œ ì¼ê´€ì„± í™•ë³´
4. **í…ŒìŠ¤íŠ¸ ê°€ëŠ¥ì„±**: ë¡œì§ì´ í›…ìœ¼ë¡œ ë¶„ë¦¬ë˜ì–´ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ìš©ì´
5. **ë³¸ì¸ í˜ì´ì§€ ë²„ê·¸ ìˆ˜ì •**: ì‚­ì œ ë²„íŠ¼ ì œê±°

ì´ ê³„íšì„ ë°”íƒ•ìœ¼ë¡œ ë‹¨ê³„ì ìœ¼ë¡œ ì§„í–‰í•˜ì‹œë©´ ì•ˆì „í•˜ê²Œ ë¦¬íŒ©í† ë§í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤!

í›Œë¥­í•˜ê²Œ ì •ë¦¬-ê³„íší•˜ì…¨ìŠµë‹ˆë‹¤!  
ì•„ë˜ì—ëŠ” ê° Phase ë³„ë¡œ â€œì‹¤í–‰ ì‹œ ì£¼ì˜í•  ì â€ + â€œì¶”ê°€ ë³´ì™„ ì•„ì´ë””ì–´â€ë¥¼ ë‹¬ì•„ ë‘ì—ˆìœ¼ë‹ˆ ì°©ìˆ˜ ì „ì— í•œ ë²ˆ ë” ì²´í¬í•´ ë³´ì‹œë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  
Phase 1 â€• íƒ€ì…Â·ìƒìˆ˜ ì •ë¦¬  
1. `types.ts`ì˜ `ClinicalCase` í™•ì¥ì€ ê¸°ì¡´ í˜ì´ì§€ì—ì„œ ë°”ë¡œ import í•´ ì˜¤ë¯€ë¡œ **ì‚¬ì´í´ ë¬¸ì œ**(ì»´í¬ë„ŒíŠ¸ â†” í›… â†” íƒ€ì…)ê°€ ì—†ëŠ”ì§€ë§Œ í™•ì¸í•˜ì„¸ìš”.  
2. `SYSTEM_OPTIONS`ë¥¼ ë”°ë¡œ ë‘ë©´ ê¸°ì¡´ íŒŒì¼ë“¤ì—ì„œ ì—¬ëŸ¬ ë²ˆ import í•´ì•¼ í•©ë‹ˆë‹¤. `export * from './constants'` ë°©ì‹ìœ¼ë¡œ re-export í•´ ë‘ë©´ ê²½ë¡œ íƒ€ì´í•‘ì„ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
3. `as const` ëŠ” literal type ìœ¼ë¡œ ê³ ì •ë˜ë¯€ë¡œ ì¶”í›„ Admin ìª½ì—ì„œ `SYSTEM_OPTIONS`ë¥¼ ë™ì ìœ¼ë¡œ ë°›ì•„ì•¼ í•  ë•ŒëŠ” enum â†’ ë ˆì½”ë“œ â†’ API fetch ë¡œ êµì²´í•˜ê¸° ì‰½ë„ë¡ ì£¼ì„ì„ ë‹¬ì•„ë‘ì„¸ìš”.

Phase 2 â€• API ë ˆì´ì–´  
1. `fetchCases()`ëŠ” í´ë¼ì´ì–¸íŠ¸-ì‚¬ì´ë“œ í˜¸ì¶œì¸ë° pagination ì´ ì—†ìœ¼ë¯€ë¡œ ì¼€ì´ìŠ¤ ìˆ˜ê°€ 1000 ê±´ ì´ìƒ ëŠ˜ì–´ë‚  ë•Œ ëŒ€ë¹„í•´ **ì„œë²„ ì¸¡ í•„í„°(ì¿¼ë¦¬ ë§¤ê°œë³€ìˆ˜)** ë„ ê³ ë ¤í•´ ë‘ë©´ ì¢‹ìŠµë‹ˆë‹¤.  
2. `ensurePersonalCaseExists()` ì•ˆì—ì„œ create í›„ ê³§ë°”ë¡œ Supabase ì‘ë‹µì„ ë‹¤ì‹œ ì½ìœ¼ë¯€ë¡œ network round-trip ì´ ë‘ ë²ˆ ìƒê¹ë‹ˆë‹¤. ìƒì„± ì§í›„ ë°˜í™˜ê°’ì„ ì„œë¹„ìŠ¤ ëª¨ë¸ì— ë°”ë¡œ ë§¤í•‘í•˜ë©´ í•œ ë²ˆìœ¼ë¡œ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
3. `clinical-photos-api` ì— ì‹ ê·œ í•¨ìˆ˜ ì¶”ê°€ ì‹œ **RLS ì •ì±…**(ì½ê¸°/ì“°ê¸° ê¶Œí•œ) í™•ì¸ì„ ìŠì§€ ë§ˆì„¸ìš”. dev DBì—ì„œëŠ” í—ˆìš©ë˜ì§€ë§Œ prod ì—ì„œëŠ” ë§‰íˆëŠ” ì‚¬ë¡€ê°€ ë§ì•˜ìŠµë‹ˆë‹¤.

Phase 3 â€• ì»¤ìŠ¤í…€ í›…  
1. `useCaseManagement` ì˜ `loadCases()` ëŠ” ì—­í• ìƒ `useEffect(() => { loadCases() }, [])` ì—ì„œ í˜¸ì¶œë  í…ë°, ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸ ì‹œ **abort controller** ë¡œ fetch ì·¨ì†Œí•´ ë‘ë©´ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤.  
2. í›… ë‚´ë¶€ì—ì„œ ë°˜í™˜í•˜ëŠ” `setCases` ë¥¼ ê·¸ëŒ€ë¡œ ë…¸ì¶œí•˜ë©´ ì™¸ë¶€ì—ì„œ ì§ì ‘ ìƒíƒœë¥¼ ê¼¬ì´ê²Œ ë§Œë“¤ ìˆ˜ ìˆìœ¼ë‹ˆ,  
   ```ts
   const update = (id, cb) => setCases(prev => prev.map(c => c.id===id?cb(c):c));
   return { cases, loading, refresh: loadCases, update };
   ```  
   ì²˜ëŸ¼ ë˜í•‘í•˜ì—¬ ìµœì†Œí•œì˜ public API ë§Œ ë…¸ì¶œí•˜ëŠ” í¸ì´ ì•ˆì „í•©ë‹ˆë‹¤.

Phase 4 â€• CaseCard  
1. ì–¼ë§ˆë‚˜ ì¡°ê°ë‚¼ì§€ ê¸°ì¤€ì€ â€œë™ì¼ ìƒíƒœë¥¼ ì½ê³  ì“°ëŠ” ì»´í¬ë„ŒíŠ¸ë¼ë¦¬ëŠ” í•œ ë©ì–´ë¦¬â€ì…ë‹ˆë‹¤. ì˜ˆ) CustomerInfoSection ê³¼ ProductSection ì´ ì„œë¡œ ë…ë¦½ì´ë©´ ë¶„ë¦¬, **ë©”ëª¨ ì…ë ¥ ì‹œ ì œí’ˆ ì„¹ì…˜ë„ rerender ë  í•„ìš”ê°€ ì—†ë‹¤** â†’ memo ë¶„í• .  
2. CSS ë ˆì´ì•„ì›ƒì€ ê¸°ì¡´ Tailwind í´ë˜ìŠ¤ë¥¼ ê·¸ëŒ€ë¡œ ì˜®ê²¨ì˜¤ë˜, **wrap div ê°¯ìˆ˜**ë¥¼ ì¤„ì—¬ DOM íŠ¸ë¦¬ë¥¼ ì–‡ê²Œ í•˜ë©´ ëª¨ë°”ì¼ ì„±ëŠ¥ì´ ì¢‹ì•„ì§‘ë‹ˆë‹¤.

Phase 5 â€• í˜ì´ì§€ ë¦¬íŒ©í† ë§  
1. í˜„ì¬ ë¼ìš°íŠ¸ íŒŒì¼ëª…ì€ `/upload/personal/page.tsx`, `/upload/customer/page.tsx` ì¸ë° **ê³µí†µ ì»´í¬ë„ŒíŠ¸ import ê²½ë¡œ ë³€ê²½**ì´ ëŒ€ëŸ‰ ë°œìƒí•©ë‹ˆë‹¤. VSCode bulk rename(Shift + Alt + O) ê¸°ëŠ¥ì„ í™œìš©í•˜ë©´ ì‹œê°„ì„ ì ˆì•½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
2. ìŠ¤í¬ë¡¤ ì• ë‹ˆë©”ì´ì…˜(`useScrollNumberAnimation`) ë¶„ë¦¬ëŠ” Phase 5ì—ì„œ ê°™ì´ í•´ ë‘ë©´ CaseCard ë‚´ë¶€ê°€ ë” ê°„ê²°í•´ì§‘ë‹ˆë‹¤.

Phase 6 â€• í…ŒìŠ¤íŠ¸  
1. Supabase í†µí•© í…ŒìŠ¤íŠ¸ëŠ” `@supabase/cli` ë¡œ ë¡œì»¬ DB ìŠ¤í•€ì—…ì´ í•„ìš”í•©ë‹ˆë‹¤. Vitest ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ â†’ mocking ìœ¼ë¡œ ì¶©ë¶„í•˜ê³ , í†µí•© í…ŒìŠ¤íŠ¸ëŠ” GitHub Actions Matrix (job í•˜ë‚˜)ë¥¼ ì“°ë©´ ë©ë‹ˆë‹¤.  
2. ì»¤ìŠ¤í…€ í›…ì€ `renderHook` (Vitest + Testing-Library) íŒ¨í„´ì´ë©´ ê¸ˆë°© ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì¶”ê°€ ì²´í¬-ë¦¬ìŠ¤íŠ¸  
â€¢ ESLint í”ŒëŸ¬ê·¸ì¸ì— `"simple-import-sort/imports"` / `"simple-import-sort/exports"` ê·œì¹™ì„ ì¶”ê°€í•´ ë‘ë©´ Phase 4ì—ì„œ import ìˆœì„œ í˜¼ë€ì´ ì¤„ì–´ë“­ë‹ˆë‹¤.  
â€¢ `PERSONAL_CASE_NAME` ê³¼ ê°™ì€ â€œë¹„ì¦ˆë‹ˆìŠ¤ ìƒìˆ˜â€ëŠ” `.env` ë¡œ ë¹¼ë©´ ìš´ì˜ ì¤‘ì— ë¬¸ìì—´ì„ ë°”ê¿€ ë•Œ ì½”ë“œ ë°°í¬ê°€ í•„ìš” ì—†ìŠµë‹ˆë‹¤. (ì˜ˆ: `NEXT_PUBLIC_PERSONAL_CASE_NAME`)  
â€¢ ì‚­ì œ API í˜¸ì¶œ ì‹œ race condition(ì´ë¯¸ ì‚­ì œëœ í•­ëª© ë‹¤ì‹œ ì‚­ì œ ìš”ì²­) ëŒ€ë¹„ 409, 404 ì‘ë‹µì„ í•¸ë“¤ë§í•´ ë‘ë©´ UX ê°€ ê¹”ë”í•©ë‹ˆë‹¤.  
â€¢ ë§ˆì§€ë§‰ìœ¼ë¡œ **analytics/logging**: ë¦¬íŒ©í„°ë§ í›„ ì˜¤ë¥˜ ì¶”ì ì„ ìœ„í•´ Sentry ë˜ëŠ” Supabase Functions ë¡œê·¸ë¥¼ í™•ì¸í•  ê²½ë¡œë¥¼ ë¯¸ë¦¬ ë¬¸ì„œí™”í•´ ë‘ì„¸ìš”.

ì´ìƒì…ë‹ˆë‹¤. ì¤€ë¹„í•˜ì‹  ì¼ì •Â·ë‹¨ê³„ì™€ ì¶©ë¶„íˆ í˜¸í™˜ë˜ë©°, ìœ„ ë³´ì™„ ì‚¬í•­ê¹Œì§€ ë°˜ì˜í•˜ë©´ ë”ìš± ê²¬ê³ í•œ êµ¬ì¡°ê°€ ë  ê²ƒì…ë‹ˆë‹¤.  
ì§„í–‰í•˜ì‹œë‹¤ ë§‰íˆëŠ” ë¶€ë¶„ì´ë‚˜ ì¶”ê°€ ê²€í† ê°€ í•„ìš”í•˜ë©´ ì–¸ì œë“  ë§ì”€í•´ ì£¼ì„¸ìš”!