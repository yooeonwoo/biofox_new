⚠️ 중요: 코드를 구현하지 말고, 질문에 대한 답변만 해주세요.

현재 프로젝트에 푸시 알림 기능을 추가하려고 합니다. 기존 구조를 파악하기 위해 다음 질문들에 답변해주세요:

## 🏗️ 프로젝트 기본 구조
1. Next.js 버전과 주요 의존성 패키지들은 무엇인가요? (package.json 확인)
2. Supabase 설정은 어떻게 되어있나요? (클라이언트 설정, 환경변수)
3. 현재 사용 중인 UI 라이브러리는 무엇인가요? (shadcn/ui, TailwindCSS 등)

## 👥 RBAC 권한 시스템  
4. 현재 사용자 권한(role) 종류가 몇 개이고, 각각 어떤 이름인가요?
5. 권한 확인은 어떤 방식으로 하고 있나요? (middleware, hook, 컴포넌트)
6. KOL과 관리자 권한의 차이점은 무엇인가요?

## 🗄️ 데이터베이스 구조
7. 사용자 테이블 구조는 어떻게 되어있나요? (users 테이블의 주요 컬럼들)
8. 권한/역할 관리는 어느 테이블에서 하고 있나요?
9. 현재 알림 관련 테이블이 있나요? 있다면 구조는?

## 🔄 상태 관리 & API
10. 전역 상태 관리는 어떤 도구를 사용하나요? (Zustand, Context, Redux 등)
11. 사용자 정보는 어떻게 관리하고 있나요? (로그인 상태, 권한 정보)
12. API 호출은 어떤 패턴으로 하고 있나요? (fetch, axios, SWR, React Query 등)

## 🎨 현재 UI 패턴
13. 토스트/알림 메시지는 현재 어떤 컴포넌트로 표시하나요?
14. 모달/다이얼로그는 어떤 컴포넌트를 사용하나요?
15. 로딩 상태는 어떻게 처리하고 있나요?

## 📱 타겟 사용자
16. 주로 모바일 사용자인가요, 데스크톱 사용자인가요?
17. PWA 설정이 되어있나요? (manifest.json, service worker)

## 🔔 알림 요구사항
18. 어떤 상황에서 알림을 보내려고 하나요? (메시지, 승인, 작업 완료 등)
19. KOL이 다른 KOL에게 보낼 수 있는 알림 유형은?
20. 관리자가 보낼 수 있는 알림 유형은?

답변 후에 현재 프로젝트에서 가장 중요한 파일들의 경로도 알려주세요:
- 메인 레이아웃 파일
- 사용자 인증 관련 파일  
- 권한 체크 관련 파일
- 주요 페이지 컴포넌트들


<답변>


  🏗️ 프로젝트 기본 구조

  1. Next.js 버전과 주요 의존성
  - Next.js: ^15.2.3
  - React: ^19.1.0
  - TypeScript: ^5.8.2
  - Tailwind CSS: ^3.4.1
  - Drizzle ORM: ^0.41.0 (스키마 정의용)
  - Clerk: ^6.20.1 (인증)

  2. Supabase 설정
  - 프로젝트명: BIOFOX KOL
  - 프로젝트 ID: lgzzqoaiukuywmenxzay
  - Region: ap-northeast-2 (Seoul)
  - URL: https://lgzzqoaiukuywmenxzay.supabase.co
  - 클라이언트: @supabase/supabase-js ^2.49.8
  - 환경변수 사용 중

  3. UI 라이브러리
  - shadcn/ui (Radix UI 기반)
  - Tailwind CSS
  - Framer Motion
  - Lucide React 아이콘

  👥 RBAC 권한 시스템

  4. 실제 사용자 권한 종류 (DB 확인)
  - admin: 1명 (관리자)
  - kol: 39명 (Key Opinion Leader)
  - 프론트엔드 코드에는 admin-new, user도 정의되어 있으나 실제
   DB에는 없음

  5. 권한 확인 방식
  - Clerk 미들웨어에서 라우트 보호
  - Clerk의 publicMetadata.role 사용
  - DB의 users.role과 동기화
  - /lib/auth.ts의 인증 함수들

  6. KOL vs 관리자 차이
  - KOL: 자신의 데이터만 접근 (본인 전문점, 매출, 임상사진)
  - 관리자: 전체 시스템 데이터 접근 및 관리

  🗄️ 데이터베이스 구조 (실제 DB)

  7. 사용자 테이블 (users) - 실제 컬럼
  - id: integer (PK)
  - clerk_id: varchar(255) NOT NULL UNIQUE
  - email: varchar(255) NOT NULL UNIQUE
  - name: varchar(255) NULL
  - role: varchar(50) NOT NULL default 'kol'
  - created_at, updated_at: timestamptz

  8. 권한 관리
  - users 테이블의 role 컬럼
  - 실제 데이터: admin 1명, kol 39명
  - Clerk publicMetadata와 동기화

  9. 알림 테이블 (notifications) - 실제 구조
  - id: integer (PK)
  - user_id: integer NOT NULL (FK to users)
  - title: varchar(255) NOT NULL
  - content: varchar(1000) NOT NULL
  - read: boolean NOT NULL default false
  - created_at, updated_at: timestamptz
  현재 알림 데이터는 비어있음 (새로 구현 필요)

  🎮 상태 관리 & API

  10. 전역 상태 관리
  - React Query (TanStack Query) v5
  - Custom hooks 패턴
  - 로컬 상태는 useState 사용

  11. 사용자 정보 관리
  - Clerk 인증 (clerk_id 사용)
  - useUser() hook
  - DB와 Clerk 동기화

  12. API 호출 패턴
  - Next.js Route Handlers
  - fetch with credentials
  - React Query hooks

  🎨 현재 UI 패턴

  13. 토스트/알림
  - shadcn/ui Toast
  - Sonner 라이브러리 (^2.0.1)
  - useToast() hook

  14. 모달/다이얼로그
  - shadcn/ui Dialog
  - Sheet (모바일 메뉴)
  - Drawer 컴포넌트

  15. 로딩 상태
  - React Query의 isLoading
  - 커스텀 Loading 컴포넌트
  - Skeleton UI

  📱 타겟 사용자

  16. 모바일 + 데스크톱
  - 완전한 반응형 디자인
  - 모바일 전용 메뉴 구현

  17. PWA 설정
  - 현재 PWA 미구현
  - 향후 추가 가능

  🔔 알림 요구사항

  18. 알림 발송 상황 (계획)
  - 새 작업 할당
  - 매출 목표 달성
  - 시스템 공지
  - 승인 요청/완료

  19. KOL → KOL 알림
  - 현재 미구현
  - DB 구조상 가능

  20. 관리자 → KOL 알림
  - 시스템 공지
  - 작업 할당
  - 성과 알림

  📁 주요 파일 경로

  메인 레이아웃: /app/layout.tsx

  인증 관련:
  - /middleware.ts - Clerk 미들웨어
  - /lib/auth.ts - 인증 유틸리티
  - /lib/clerk-client.ts - Clerk 설정

  권한 체크:
  - /middleware.ts:37-88 - 라우트 보호
  - /lib/auth.ts:240-298 - API 권한 검증

  주요 페이지:
  - KOL 대시보드: /app/kol-new/page.tsx
  - KOL 알림: /app/kol-new/notifications/page.tsx
  - 관리자: /app/admin-dashboard/page.tsx

  🔧 Supabase 활성 기능

  현재 활성화된 Extensions:
  - uuid-ossp (UUID 생성)
  - pgcrypto (암호화)
  - pg_net (HTTP 요청)
  - pg_graphql (GraphQL API)
  - pgjwt (JWT)
  - pg_stat_statements (쿼리 통계)
  - pg_cron (스케줄러)
  - pgsodium (암호화)
  - supabase_vault (시크릿 관리)

  푸시 알림 구현 시 활용 가능한 기능:
  - Realtime (웹소켓 기반 실시간 통신)
  - Edge Functions (푸시 알림 전송)
  - Database Webhooks (DB 변경 시 알림 트리거)
  - pg_net (외부 푸시 서비스 호출)
</답변>
