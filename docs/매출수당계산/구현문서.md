# 매출수당계산 기능 구현 문서

## 1. 개요

이 문서는 매출수당계산 기능의 구현 상태를 설명합니다. 이 기능은 KOL이 자신의 소속 전문점들의 매출과 수당을 확인하고 관리할 수 있는 기능을 제공합니다.

## 2. 구현된 페이지

### 2.1 대시보드 페이지 (`/dashboard/sales`)

KOL의 매출 및 수당 요약 정보를 제공하는 메인 대시보드 페이지입니다.

#### 주요 기능
- 당월 매출, 당월 수당, 월평균 매출, 누적 수당 등의 요약 정보 표시
- 전월과 당월 비교 차트
- 월별 매출/수당 추이 그래프 
- 제품별 매출 비율 차트
- 전문점 활성 현황 위젯

#### 사용된 컴포넌트
- `SalesSummary`: 매출/수당 요약 정보 표시
- `MonthlyTrendChart`: 월별 매출/수당 추이 차트
- `ProductRatioChart`: 제품별 매출 비율 차트
- `ShopStatusWidget`: 전문점 활성 현황 위젯
- `MonthSelector`: 월 선택 UI

### 2.2 전문점 순위 페이지 (`/dashboard/shops`)

KOL 소속 전문점들의 순위 정보를 표시하는 페이지입니다.

#### 주요 기능
- 전문점 순위 테이블 (당월매출, 월평균매출, 누적매출 기준 정렬 가능)
- 월 선택 필터

#### 사용된 컴포넌트
- `ShopRankingTable`: 전문점 순위 테이블
- `MonthSelector`: 월 선택 UI

### 2.3 전문점 상세 페이지 (`/dashboard/shops/[shopId]`)

개별 전문점의 상세 정보를 표시하는 페이지입니다.

#### 주요 기능
- 전문점 기본 정보 (이름, 점주명, 지역 등)
- 당월 매출, 기기 매출, 총 매출, 수당 요약 카드
- 제품별 매출 비율 차트
- 월별 매출/수당 추이 차트

#### 사용된 컴포넌트
- `SummaryCard`: 요약 정보 카드
- `ProductRatioChart`: 제품별 매출 비율 차트
- 월별 매출/수당 추이 차트
- `MonthSelector`: 월 선택 UI

### 2.4 수당 내역 페이지 (`/dashboard/commissions`)

KOL의 수당 내역을 관리하는 페이지입니다.

#### 주요 기능
- 수당 내역 테이블 (발생일, 전문점, 수당 금액, 정산 상태 등)
- 정산 상태 필터 (전체, 정산 완료, 정산 대기)
- 월별 수당 요약 테이블 (발생 수당, 정산 수당, 미정산 수당)

#### 사용된 컴포넌트
- 데이터 테이블
- 필터 UI
- `MonthSelector`: 월 선택 UI

## 3. API 엔드포인트

### 3.1 매출 및 수당 요약 API

- `GET /api/sales/monthly-summary`: KOL의 월별 매출, 수당, 전월 대비 비교 데이터 조회
- `GET /api/sales/monthly-summary/list`: KOL의 여러 달에 걸친 매출, 수당 요약 데이터 조회

### 3.2 제품 매출 비율 API

- `GET /api/sales/product-ratios`: 전문점/KOL별 월간 제품 매출 비율 데이터 조회

### 3.3 전문점 순위 API

- `GET /api/sales/shop-ranking`: 전문점 순위 데이터 조회

### 3.4 전문점 상세 정보 API

- `GET /api/sales/shop-details/[shopId]`: 특정 전문점의 상세 데이터 조회

### 3.5 수당 내역 API (구현 예정)

- `GET /api/sales/commission-history`: 수당 내역 데이터 조회
- `GET /api/sales/commission-summary`: 월별 수당 요약 데이터 조회

## 4. 컴포넌트 구조

### 4.1 대시보드 공통 컴포넌트

- `MonthSelector`: 연월 선택 컴포넌트 (`components/dashboard/MonthSelector.tsx`)
- `SummaryCard`: 요약 정보 카드 컴포넌트 (`components/dashboard/SummaryCard.tsx`)

### 4.2 매출 관련 컴포넌트

- `SalesSummary`: 매출/수당 요약 컴포넌트 (`components/dashboard/SalesSummary.tsx`)
- `MonthlyTrendChart`: 월별 추이 차트 컴포넌트 (`components/dashboard/MonthlyTrendChart.tsx`)
- `ProductRatioChart`: 제품별 매출 비율 차트 컴포넌트 (`components/dashboard/ProductRatioChart.tsx`)
- `ShopStatusWidget`: 전문점 활성 현황 위젯 컴포넌트 (`components/dashboard/ShopStatusWidget.tsx`)
- `ShopRankingTable`: 전문점 순위 테이블 컴포넌트 (`components/dashboard/ShopRankingTable.tsx`)

## 5. 네비게이션 구조

대시보드 레이아웃에 다음과 같은 네비게이션 메뉴가 추가되었습니다:

```
└── 매출/수당 관리
    ├── 대시보드         (/dashboard/sales)
    ├── 전문점 순위      (/dashboard/shops)
    └── 수당 내역        (/dashboard/commissions)
```

이 메뉴는 `app/dashboard/layout.tsx`에 사이드바 형태로 구현되어 있습니다.

## 6. 향후 개선 사항

### 6.1 기능 개선

- 수당 정산 관리 기능 강화: 정산 상태 변경, 정산 내역 관리 기능 추가
- 실시간 데이터 업데이트: 웹소켓 또는 서버 이벤트를 통한 실시간 데이터 업데이트
- 데이터 필터링 및 검색 기능 강화: 다양한 조건으로 데이터 필터링 및 검색 가능

### 6.2 UI/UX 개선

- 모바일 반응형 최적화: 모바일 뷰에서의 사용성 개선
- 다크 모드 지원: 시스템 테마에 따른 다크 모드 지원
- 차트 상호작용 강화: 차트 데이터 드릴다운, 호버 인터랙션 개선

### 6.3 보고서 기능

- 엑셀/PDF 보고서 다운로드: 매출 및 수당 데이터의 보고서 형태 다운로드 기능
- 커스텀 리포트 생성: 사용자가 원하는 형태의 보고서 생성 기능

## 7. 테스트 및 운영 환경

### 7.1 테스트 방법

- 각 페이지의 로딩 시간 및 반응성 테스트
- 다양한 화면 크기에서의 반응형 레이아웃 테스트
- API 응답 속도 및 오류 처리 테스트

### 7.2 데이터 로딩 전략

현재는 각 컴포넌트에서 독립적으로 데이터를 로드하고 있으며, 추후 React Query 또는 SWR을 사용한 데이터 로딩 및 캐싱 전략을 적용할 예정입니다. 